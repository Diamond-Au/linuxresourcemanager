<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>process info</title>
    <link rel="stylesheet" href="./index.css" />
  </head>
  <body>
    <div id="process-info"></div>
    <div id="operator">
      <div class="button kill">kill</div>
      <div class="button-refresh button refresh">refresh</div>
      <span class="process-count"></span>
    </div>
  </body>
  <script>
    const { getProcessInfo } = require("../../utils/index.js");
    const { renderProcessInfo } = require("../../utils/render.js");
    const processInfo = document.getElementById("process-info");
    const processCount = document.querySelector(".process-count");
    const btn = document.querySelector(".button");
    const refreshBtn = document.querySelector(".button-refresh");
    let currentPid = null;
    window.onload = function () {
      const box = document.querySelector(".info-content");
      let processInfoResult = getProcessInfo();
      let template = renderProcessInfo(processInfoResult);
      processInfo.innerHTML = template;
      processCount.innerHTML = `process count: ${processInfoResult.length}`;
      /*
       * repeat excute the code to rerender the page
       */

      function sleep() {
        return new Promise((resolve) => {
          resolve();
        });
      }

      processInfo.onclick = function (e) {
        let currentcontent = e.target.parentNode;
        currentPid = currentcontent.dataset.pid;
        console.log(currentPid);
      };
      btn.onclick = function () {
        console.log(currentPid);
      };
      refreshBtn.onclick = function () {
        processInfoResult = getProcessInfo();
        template = renderProcessInfo(processInfoResult);
        processInfo.innerHTML = template;
        processCount.innerHTML = `process count: ${processInfoResult.length}`;
        console.log("refresh");
      };
    };
  </script>
</html>
